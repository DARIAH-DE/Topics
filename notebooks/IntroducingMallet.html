
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Topics – Easy Topic Modeling in Python &#8212; DARIAH Topic Modeling 1.0.0.dev documentation</title>
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  <div class="document">
    
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">DARIAH Topic Modeling</a></h1>






<p>
<iframe src="https://ghbtns.com/github-btn.html?user=DARIAH-DE&repo=Topics&type=watch&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>





<h3>Navigation</h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../README.html">Topics – Easy Topic Modeling in Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../docs/gen/modules.html">API Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../docs/CONTRIBUTING.html">Information for Contributors</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput,
div.nbinput div.prompt,
div.nbinput div.input_area,
div.nbinput div[class*=highlight],
div.nbinput div[class*=highlight] pre,
div.nboutput,
div.nbinput div.prompt,
div.nbinput div.output_area,
div.nboutput div[class*=highlight],
div.nboutput div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput,
div.nboutput {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput,
    div.nboutput {
        flex-direction: column;
    }
}

/* input container */
div.nbinput {
    padding-top: 5px;
}

/* last container */
div.nblast {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput div.prompt pre {
    color: #303F9F;
}

/* output prompt */
div.nboutput div.prompt pre {
    color: #D84315;
}

/* all prompts */
div.nbinput div.prompt,
div.nboutput div.prompt {
    min-width: 8ex;
    padding-top: 0.4em;
    padding-right: 0.4em;
    text-align: right;
    flex: 0;
}
@media (max-width: 540px) {
    div.nbinput div.prompt,
    div.nboutput div.prompt {
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput div.prompt.empty {
        padding: 0;
    }
}

/* disable scrollbars on prompts */
div.nbinput div.prompt pre,
div.nboutput div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput div.input_area,
div.nboutput div.output_area {
    padding: 0.4em;
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput div.input_area,
    div.nboutput div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput div.input_area {
    border: 1px solid #cfcfcf;
    border-radius: 2px;
    background: #f7f7f7;
}

/* override MathJax center alignment in output cells */
div.nboutput div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.pngmath center alignment in output cells */
div.nboutput div.math p {
    text-align: left;
}

/* standard error */
div.nboutput div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }
</style>
<div class="section" id="Topics-–-Easy-Topic-Modeling-in-Python">
<h1>Topics – Easy Topic Modeling in Python<a class="headerlink" href="#Topics-–-Easy-Topic-Modeling-in-Python" title="Permalink to this headline">¶</a></h1>
<p>The text mining technique <strong>Topic Modeling</strong> has become a popular
statistical method for clustering documents. This <a class="reference external" href="http://jupyter.org/">Jupyter
notebook</a> introduces a step-by-step workflow,
basically containing data preprocessing, the actual topic modeling using
<strong>latent Dirichlet allocation</strong> (LDA), which learns the relationships
between words, topics, and documents, as well as some interactive
visualizations to explore the model.</p>
<p>LDA, introduced in the context of text analysis in
<a class="reference external" href="http://www.jmlr.org/papers/volume3/blei03a/blei03a.pdf">2003</a>, is an
instance of a more general class of models called <strong>mixed-membership
models</strong>. Involving a number of distributions and parameters, the topic
model is typically performed using <a class="reference external" href="https://en.wikipedia.org/wiki/Gibbs_sampling">Gibbs
sampling</a> with
conjugate priors and is purely based on word frequencies.</p>
<p>There have been written numerous introductions to topic modeling for
humanists (e.g. <a class="reference external" href="http://scottbot.net/topic-modeling-for-humanists-a-guided-tour/">this
one</a>),
which provide another level of detail regarding its technical and
epistemic properties.</p>
<p>For this workflow, you will need a corpus (a set of texts) as plain text
(<code class="docutils literal notranslate"><span class="pre">.txt</span></code>) or <a class="reference external" href="http://www.tei-c.org/index.xml">TEI XML</a> (<code class="docutils literal notranslate"><span class="pre">.xml</span></code>).
Using the <code class="docutils literal notranslate"><span class="pre">dariah_topics</span></code> package, you also have the ability to
process the output of
<a class="reference external" href="https://github.com/DARIAH-DE/DARIAH-DKPro-Wrapper">DARIAH-DKPro-Wrapper</a>,
a command-line tool for <em>natural language processing</em>.</p>
<p>Topic modeling works best with very large corpora. The <a class="reference external" href="https://textgridrep.org/">TextGrid
Repository</a> is a great place to start
searching for text data. Anyway, to demonstrate the technique, we
provide one small text collection in the folder <code class="docutils literal notranslate"><span class="pre">grenzboten_sample</span></code>
containing 15 diary excerpts, as well as 15 war diary excerpts, which
appeared in <em>Die Grenzboten</em>, a German newspaper of the late 19th and
early 20th century.</p>
<p><strong>Of course, you can work with your own corpus in this notebook.</strong></p>
<p>We’re relying on the LDA implementation by <a class="reference external" href="https://people.cs.umass.edu/~mccallum/">Andrew
McCallum</a>, called
<a class="reference external" href="http://mallet.cs.umass.edu/topics.php">MALLET</a>, which is known to be
very robust. Aside from that, we provide two more Jupyter notebooks:</p>
<ul class="simple">
<li>IntroducingGensim, using LDA by
<a class="reference external" href="https://radimrehurek.com/project/gensim/">Gensim</a>, which is
attractive because of its multi-core support.</li>
<li>IntroducingLda, using LDA by
<a class="reference external" href="http://pythonhosted.org/lda/index.html">lda</a>, which is very
lightweight.</li>
</ul>
<p>For more information in general, have a look at the
<a class="reference external" href="http://dev.digital-humanities.de/ci/job/DARIAH-Topics/doclinks/1/">documentation</a>.</p>
<div class="section" id="First-step:-Installing-dependencies">
<h2>First step: Installing dependencies<a class="headerlink" href="#First-step:-Installing-dependencies" title="Permalink to this headline">¶</a></h2>
<p>To work within this Jupyter notebook, you will have to import the
<code class="docutils literal notranslate"><span class="pre">dariah_topics</span></code> library. As you do, <code class="docutils literal notranslate"><span class="pre">dariah_topics</span></code> also imports a
couple of external libraries, which have to be installed first. <code class="docutils literal notranslate"><span class="pre">pip</span></code>
is the preferred installer program in Python. Starting with Python 3.4,
it is included by default with the Python binary installers. If you are
interested in <code class="docutils literal notranslate"><span class="pre">pip</span></code>, have a look at <a class="reference external" href="https://docs.python.org/3/installing/index.html">this
website</a>.</p>
<p>To install the <code class="docutils literal notranslate"><span class="pre">dariah_topics</span></code> library with all dependencies, open
your commandline, go with <code class="docutils literal notranslate"><span class="pre">cd</span></code> to the folder <code class="docutils literal notranslate"><span class="pre">Topics</span></code> and run:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="o">-</span><span class="n">r</span> <span class="n">requirements</span><span class="o">.</span><span class="n">txt</span>
</pre></div>
</div>
<p>Alternatively, you can do:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="n">setup</span><span class="o">.</span><span class="n">py</span> <span class="n">install</span>
</pre></div>
</div>
<p>If you get any errors or are not able to install <em>all</em> dependencies
properly, try <a class="reference external" href="https://stackoverflow.com/questions/tagged/pip">Stack
Overflow</a> for
troubleshooting or create a new issue on our <a class="reference external" href="https://github.com/DARIAH-DE/Topics">GitHub
page</a>.</p>
<p><strong>Important</strong>: If you are on macOS or Linux, you will have to use
<code class="docutils literal notranslate"><span class="pre">pip3</span></code> and <code class="docutils literal notranslate"><span class="pre">python3</span></code>.</p>
<div class="section" id="Some-final-words">
<h3>Some final words<a class="headerlink" href="#Some-final-words" title="Permalink to this headline">¶</a></h3>
<p>As you probably already know, code has to be written in the grey cells.
You execute a cell by clicking the <strong>Run</strong>-button (or <strong>Ctrl + Enter</strong>).
If you want to run all cells of the notebook at once, click <strong>Cell &gt; Run
All</strong> or <strong>Kernel &gt; Restart &amp; Run All</strong> respectively, if you want to
restart the Python kernel first. On the left side of an (unexecuted)
cell stands <code class="docutils literal notranslate"><span class="pre">In</span> <span class="pre">[</span> <span class="pre">]:</span></code>. The empty bracket means, that the cell hasn’t
been executed yet. By clicking <strong>Run</strong>, a star appears in the brackets
(<code class="docutils literal notranslate"><span class="pre">In</span> <span class="pre">[*]:</span></code>), which means the process is running. In most cases, you
won’t see that star, because your computer is faster than your eyes. You
can execute only one cell at once, all following executions will be in
the waiting line. If the process of a cell is done, a number appears in
the brackets (<code class="docutils literal notranslate"><span class="pre">In</span> <span class="pre">[1]:</span></code>).</p>
</div>
</div>
<div class="section" id="Starting-with-topic-modeling!">
<h2>Starting with topic modeling!<a class="headerlink" href="#Starting-with-topic-modeling!" title="Permalink to this headline">¶</a></h2>
<p>Execute the following cell to import modules from the <code class="docutils literal notranslate"><span class="pre">dariah_topics</span></code>
library.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">dariah_topics</span> <span class="k">import</span> <span class="n">preprocessing</span>
<span class="kn">from</span> <span class="nn">dariah_topics</span> <span class="k">import</span> <span class="n">utils</span>
<span class="kn">from</span> <span class="nn">dariah_topics</span> <span class="k">import</span> <span class="n">postprocessing</span>
<span class="kn">from</span> <span class="nn">dariah_topics</span> <span class="k">import</span> <span class="n">visualization</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">ModuleNotFoundError</span>                       Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-1-3cf9ddb85e05&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span><span class="ansi-green-fg">from</span> dariah_topics <span class="ansi-green-fg">import</span> preprocessing
<span class="ansi-green-intense-fg ansi-bold">      2</span> <span class="ansi-green-fg">from</span> dariah_topics <span class="ansi-green-fg">import</span> utils
<span class="ansi-green-intense-fg ansi-bold">      3</span> <span class="ansi-green-fg">from</span> dariah_topics <span class="ansi-green-fg">import</span> postprocessing
<span class="ansi-green-intense-fg ansi-bold">      4</span> <span class="ansi-green-fg">from</span> dariah_topics <span class="ansi-green-fg">import</span> visualization

<span class="ansi-red-fg">ModuleNotFoundError</span>: No module named &#39;dariah_topics&#39;
</pre></div></div>
</div>
<p>Furthermore, we will need some additional functions from external
libraries.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">metadata_toolbox.utils</span> <span class="k">as</span> <span class="nn">metadata</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="k">import</span> <span class="n">Path</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">ModuleNotFoundError</span>                       Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-2-56700d6b0cf1&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span><span class="ansi-green-fg">import</span> metadata_toolbox<span class="ansi-blue-fg">.</span>utils <span class="ansi-green-fg">as</span> metadata
<span class="ansi-green-intense-fg ansi-bold">      2</span> <span class="ansi-green-fg">import</span> pandas <span class="ansi-green-fg">as</span> pd
<span class="ansi-green-intense-fg ansi-bold">      3</span> <span class="ansi-green-fg">from</span> pathlib <span class="ansi-green-fg">import</span> Path

<span class="ansi-red-fg">ModuleNotFoundError</span>: No module named &#39;metadata_toolbox&#39;
</pre></div></div>
</div>
<p>Let’s not pay heed to any warnings right now and execute the following
cell.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="1.-Preprocessing">
<h2>1. Preprocessing<a class="headerlink" href="#1.-Preprocessing" title="Permalink to this headline">¶</a></h2>
<div class="section" id="1.1.-Reading-a-corpus-of-documents">
<h3>1.1. Reading a corpus of documents<a class="headerlink" href="#1.1.-Reading-a-corpus-of-documents" title="Permalink to this headline">¶</a></h3>
<div class="section" id="Defining-the-path-to-the-corpus-folder">
<h4>Defining the path to the corpus folder<a class="headerlink" href="#Defining-the-path-to-the-corpus-folder" title="Permalink to this headline">¶</a></h4>
<p>In the present example code, we are using the 30 diary excerpts from the
folder <code class="docutils literal notranslate"><span class="pre">grenzboten</span></code>. To use your own corpus, change the path
accordingly.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">path_to_corpus</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="s1">&#39;grenzboten_sample&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-4-f7d674ece687&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span>path_to_corpus <span class="ansi-blue-fg">=</span> Path<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#39;data&#39;</span><span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">&#39;grenzboten_sample&#39;</span><span class="ansi-blue-fg">)</span>

<span class="ansi-red-fg">NameError</span>: name &#39;Path&#39; is not defined
</pre></div></div>
</div>
</div>
<div class="section" id="Specifying-the-pattern-of-filenames-for-metadata-extraction">
<h4>Specifying the pattern of filenames for metadata extraction<a class="headerlink" href="#Specifying-the-pattern-of-filenames-for-metadata-extraction" title="Permalink to this headline">¶</a></h4>
<p>You have the ability to extract metadata from the filenames. For
instance, if your textfiles look like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">goethe_1816_stella</span><span class="o">.</span><span class="n">txt</span>
</pre></div>
</div>
<p>the pattern would look like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="n">author</span><span class="p">}</span><span class="n">_</span><span class="p">{</span><span class="n">year</span><span class="p">}</span><span class="n">_</span><span class="p">{</span><span class="n">title</span><span class="p">}</span>
</pre></div>
</div>
<p>So, let’s try this for the example corpus.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">pattern</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{author}</span><span class="s1">_</span><span class="si">{year}</span><span class="s1">_</span><span class="si">{title}</span><span class="s1">&#39;</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Accessing-file-paths-and-metadata">
<h4>Accessing file paths and metadata<a class="headerlink" href="#Accessing-file-paths-and-metadata" title="Permalink to this headline">¶</a></h4>
<p>We begin by creating a list of all the documents in the folder specified
above. That list will tell the function
<code class="docutils literal notranslate"><span class="pre">preprocessing.read_from_pathlist</span></code> (see below) which text documents to
read. Furthermore, based on filenames we can create some metadata, e.g.
author and title.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">meta</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">metadata</span><span class="o">.</span><span class="n">fname2metadata</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">pattern</span><span class="o">=</span><span class="n">pattern</span><span class="p">)</span> <span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="n">path_to_corpus</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s1">&#39;*.txt&#39;</span><span class="p">)])</span>
<span class="n">meta</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span> <span class="c1"># by adding &#39;[:5]&#39; to the variable, only the first 5 elements will be printed</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-6-9f07ddf53acf&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span>meta <span class="ansi-blue-fg">=</span> pd<span class="ansi-blue-fg">.</span>concat<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">[</span>metadata<span class="ansi-blue-fg">.</span>fname2metadata<span class="ansi-blue-fg">(</span>path<span class="ansi-blue-fg">,</span> pattern<span class="ansi-blue-fg">=</span>pattern<span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">for</span> path <span class="ansi-green-fg">in</span> path_to_corpus<span class="ansi-blue-fg">.</span>glob<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#39;*.txt&#39;</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">      2</span> meta<span class="ansi-blue-fg">[</span><span class="ansi-blue-fg">:</span><span class="ansi-cyan-fg">5</span><span class="ansi-blue-fg">]</span> <span class="ansi-red-fg"># by adding &#39;[:5]&#39; to the variable, only the first 5 elements will be printed</span>

<span class="ansi-red-fg">NameError</span>: name &#39;pd&#39; is not defined
</pre></div></div>
</div>
</div>
<div class="section" id="Read-listed-documents-from-folder">
<h4>Read listed documents from folder<a class="headerlink" href="#Read-listed-documents-from-folder" title="Permalink to this headline">¶</a></h4>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">corpus</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">preprocessing</span><span class="o">.</span><span class="n">read_from_pathlist</span><span class="p">(</span><span class="n">meta</span><span class="o">.</span><span class="n">index</span><span class="p">))</span>
<span class="n">corpus</span><span class="p">[</span><span class="mi">0</span><span class="p">][:</span><span class="mi">255</span><span class="p">]</span> <span class="c1"># printing the first 255 characters of the first document</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-7-6ead03db02d5&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span>corpus <span class="ansi-blue-fg">=</span> list<span class="ansi-blue-fg">(</span>preprocessing<span class="ansi-blue-fg">.</span>read_from_pathlist<span class="ansi-blue-fg">(</span>meta<span class="ansi-blue-fg">.</span>index<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">      2</span> corpus<span class="ansi-blue-fg">[</span><span class="ansi-cyan-fg">0</span><span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">[</span><span class="ansi-blue-fg">:</span><span class="ansi-cyan-fg">255</span><span class="ansi-blue-fg">]</span> <span class="ansi-red-fg"># printing the first 255 characters of the first document</span>

<span class="ansi-red-fg">NameError</span>: name &#39;preprocessing&#39; is not defined
</pre></div></div>
</div>
<p>Your <code class="docutils literal notranslate"><span class="pre">corpus</span></code> contains as much elements (<code class="docutils literal notranslate"><span class="pre">documents</span></code>) as texts in
your corpus are. Each element of <code class="docutils literal notranslate"><span class="pre">corpus</span></code> is a list containing exactly
one element, the text itself as one single string including all
whitespaces and punctuations:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[[</span><span class="s1">&#39;This is the content of your first document.&#39;</span><span class="p">],</span>
 <span class="p">[</span><span class="s1">&#39;This is the content of your second document.&#39;</span><span class="p">],</span>
 <span class="o">...</span>
 <span class="p">[</span><span class="s1">&#39;This is the content of your last document.&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="1.3.-Tokenize-corpus">
<h3>1.3. Tokenize corpus<a class="headerlink" href="#1.3.-Tokenize-corpus" title="Permalink to this headline">¶</a></h3>
<p>Now, your <code class="docutils literal notranslate"><span class="pre">documents</span></code> in <code class="docutils literal notranslate"><span class="pre">corpus</span></code> will be tokenized. Tokenization is
the task of cutting a stream of characters into linguistic units, simply
words or, more precisely, tokens. The tokenize function
<code class="docutils literal notranslate"><span class="pre">dariah_topics</span></code> provides is a simple Unicode tokenizer. Depending on
the corpus, it might be useful to use an external tokenizer function, or
even develop your own, since its efficiency varies with language, epoch
and text type.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">tokenized_corpus</span> <span class="o">=</span> <span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="n">preprocessing</span><span class="o">.</span><span class="n">tokenize</span><span class="p">(</span><span class="n">document</span><span class="p">))</span> <span class="k">for</span> <span class="n">document</span> <span class="ow">in</span> <span class="n">corpus</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-8-fd1fa485ffda&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span>tokenized_corpus <span class="ansi-blue-fg">=</span> <span class="ansi-blue-fg">[</span>list<span class="ansi-blue-fg">(</span>preprocessing<span class="ansi-blue-fg">.</span>tokenize<span class="ansi-blue-fg">(</span>document<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">for</span> document <span class="ansi-green-fg">in</span> corpus<span class="ansi-blue-fg">]</span>

<span class="ansi-red-fg">NameError</span>: name &#39;corpus&#39; is not defined
</pre></div></div>
</div>
<p>At this point, each <code class="docutils literal notranslate"><span class="pre">document</span></code> is represented by a list of separate
token strings. As above, have a look at the first document (which has
the index <code class="docutils literal notranslate"><span class="pre">0</span></code> as Python starts counting at 0) and show its first 14
words/tokens (that have the indices <code class="docutils literal notranslate"><span class="pre">0:13</span></code> accordingly).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">tokenized_corpus</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">:</span><span class="mi">13</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-9-481e811f45da&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span>tokenized_corpus<span class="ansi-blue-fg">[</span><span class="ansi-cyan-fg">0</span><span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">[</span><span class="ansi-cyan-fg">0</span><span class="ansi-blue-fg">:</span><span class="ansi-cyan-fg">13</span><span class="ansi-blue-fg">]</span>

<span class="ansi-red-fg">NameError</span>: name &#39;tokenized_corpus&#39; is not defined
</pre></div></div>
</div>
</div>
<div class="section" id="1.4-Create-a-document-term-matrix">
<h3>1.4 Create a document-term matrix<a class="headerlink" href="#1.4-Create-a-document-term-matrix" title="Permalink to this headline">¶</a></h3>
<p>The LDA topic model is based on a <a class="reference external" href="https://en.wikipedia.org/wiki/Document-term_matrix">document-term
matrix</a> of the
corpus. To improve performance in large corpora, the matrix describes
the frequency of terms that occur in the collection. In a document-term
matrix, rows correspond to documents in the collection and columns
correspond to terms.</p>
<div class="section" id="1.4.1-Large-corpus-matrix">
<h4>1.4.1 Large corpus matrix<a class="headerlink" href="#1.4.1-Large-corpus-matrix" title="Permalink to this headline">¶</a></h4>
<p>If you have a very large corpus, create a document-term matrix designed
for large corpora.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">document_term_matrix</span><span class="p">,</span> <span class="n">document_ids</span><span class="p">,</span> <span class="n">type_ids</span> <span class="o">=</span> <span class="n">preprocessing</span><span class="o">.</span><span class="n">create_document_term_matrix</span><span class="p">(</span><span class="n">tokenized_corpus</span><span class="p">,</span>
                                                                                         <span class="n">meta</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">],</span>
                                                                                         <span class="n">large_corpus</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-10-5c33454d6ac4&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> document_term_matrix, document_ids, type_ids = preprocessing.create_document_term_matrix(tokenized_corpus,
</span><span class="ansi-green-intense-fg ansi-bold">      2</span>                                                                                          meta<span class="ansi-blue-fg">[</span><span class="ansi-blue-fg">&#39;title&#39;</span><span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">,</span>
<span class="ansi-green-intense-fg ansi-bold">      3</span>                                                                                          large_corpus=True)

<span class="ansi-red-fg">NameError</span>: name &#39;preprocessing&#39; is not defined
</pre></div></div>
</div>
</div>
<div class="section" id="1.4.2-Small-corpus-matrix">
<h4>1.4.2 Small corpus matrix<a class="headerlink" href="#1.4.2-Small-corpus-matrix" title="Permalink to this headline">¶</a></h4>
<p>Otherwise, use the document-term matrix desigend for small corpora.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">document_term_matrix</span> <span class="o">=</span> <span class="n">preprocessing</span><span class="o">.</span><span class="n">create_document_term_matrix</span><span class="p">(</span><span class="n">tokenized_corpus</span><span class="p">,</span> <span class="n">meta</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">])</span>
<span class="n">document_term_matrix</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-11-d953fbd07d9e&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span>document_term_matrix <span class="ansi-blue-fg">=</span> preprocessing<span class="ansi-blue-fg">.</span>create_document_term_matrix<span class="ansi-blue-fg">(</span>tokenized_corpus<span class="ansi-blue-fg">,</span> meta<span class="ansi-blue-fg">[</span><span class="ansi-blue-fg">&#39;title&#39;</span><span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">      2</span> document_term_matrix<span class="ansi-blue-fg">[</span><span class="ansi-blue-fg">:</span><span class="ansi-cyan-fg">5</span><span class="ansi-blue-fg">]</span>

<span class="ansi-red-fg">NameError</span>: name &#39;preprocessing&#39; is not defined
</pre></div></div>
</div>
</div>
</div>
<div class="section" id="1.5.-Feature-removal">
<h3>1.5. Feature removal<a class="headerlink" href="#1.5.-Feature-removal" title="Permalink to this headline">¶</a></h3>
<p><em>Stopwords</em> (also known as <em>most frequent tokens</em>) and <em>hapax legomena</em>
are harmful for LDA and have to be removed from the corpus or the
document-term matrix respectively. In this example, the 50 most frequent
tokens will be categorized as stopwords.</p>
<p><strong>Hint</strong>: Be careful with removing most frequent tokens, you might
remove tokens quite important for LDA. Anyway, to gain better results,
it is highly recommended to use an external stopwords list.</p>
<p>In this notebook, we combine the 50 most frequent tokens, hapax legomena
and an external stopwordslist.</p>
<div class="section" id="List-the-100-most-frequent-words">
<h4>List the 100 most frequent words<a class="headerlink" href="#List-the-100-most-frequent-words" title="Permalink to this headline">¶</a></h4>
<p>If you have chosen the large corpus model, you will have to add
<code class="docutils literal notranslate"><span class="pre">type_ids</span></code> to the function <code class="docutils literal notranslate"><span class="pre">preprocessing.find_stopwords()</span></code>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">stopwords</span> <span class="o">=</span> <span class="n">preprocessing</span><span class="o">.</span><span class="n">find_stopwords</span><span class="p">(</span><span class="n">document_term_matrix</span><span class="p">,</span> <span class="n">most_frequent_tokens</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-12-5a02b1a3e2eb&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span>stopwords <span class="ansi-blue-fg">=</span> preprocessing<span class="ansi-blue-fg">.</span>find_stopwords<span class="ansi-blue-fg">(</span>document_term_matrix<span class="ansi-blue-fg">,</span> most_frequent_tokens<span class="ansi-blue-fg">=</span><span class="ansi-cyan-fg">100</span><span class="ansi-blue-fg">)</span>

<span class="ansi-red-fg">NameError</span>: name &#39;preprocessing&#39; is not defined
</pre></div></div>
</div>
<p>These are the five most frequent words:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">stopwords</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-13-5e378ed6f47f&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span>stopwords<span class="ansi-blue-fg">[</span><span class="ansi-blue-fg">:</span><span class="ansi-cyan-fg">5</span><span class="ansi-blue-fg">]</span>

<span class="ansi-red-fg">NameError</span>: name &#39;stopwords&#39; is not defined
</pre></div></div>
</div>
</div>
<div class="section" id="List-hapax-legomena">
<h4>List hapax legomena<a class="headerlink" href="#List-hapax-legomena" title="Permalink to this headline">¶</a></h4>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">hapax_legomena</span> <span class="o">=</span> <span class="n">preprocessing</span><span class="o">.</span><span class="n">find_hapax_legomena</span><span class="p">(</span><span class="n">document_term_matrix</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Total number of types in corpus:&quot;</span><span class="p">,</span> <span class="n">document_term_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Total number of hapax legomena:&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">hapax_legomena</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-14-a36e2a438a41&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span>hapax_legomena <span class="ansi-blue-fg">=</span> preprocessing<span class="ansi-blue-fg">.</span>find_hapax_legomena<span class="ansi-blue-fg">(</span>document_term_matrix<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">      2</span> print<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#34;Total number of types in corpus:&#34;</span><span class="ansi-blue-fg">,</span> document_term_matrix<span class="ansi-blue-fg">.</span>shape<span class="ansi-blue-fg">[</span><span class="ansi-cyan-fg">1</span><span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">      3</span> print<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#34;Total number of hapax legomena:&#34;</span><span class="ansi-blue-fg">,</span> len<span class="ansi-blue-fg">(</span>hapax_legomena<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span>

<span class="ansi-red-fg">NameError</span>: name &#39;preprocessing&#39; is not defined
</pre></div></div>
</div>
</div>
<div class="section" id="Optional:-Use-external-stopwordlist">
<h4>Optional: Use external stopwordlist<a class="headerlink" href="#Optional:-Use-external-stopwordlist" title="Permalink to this headline">¶</a></h4>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">path_to_stopwordlist</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="s1">&#39;stopwords&#39;</span><span class="p">,</span> <span class="s1">&#39;de.txt&#39;</span><span class="p">)</span>
<span class="n">external_stopwords</span> <span class="o">=</span> <span class="p">[</span><span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">path_to_stopwordlist</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-15-7b0c67825173&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span>path_to_stopwordlist <span class="ansi-blue-fg">=</span> Path<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#39;data&#39;</span><span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">&#39;stopwords&#39;</span><span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">&#39;de.txt&#39;</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">      2</span> external_stopwords <span class="ansi-blue-fg">=</span> <span class="ansi-blue-fg">[</span>line<span class="ansi-blue-fg">.</span>strip<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">for</span> line <span class="ansi-green-fg">in</span> path_to_stopwordlist<span class="ansi-blue-fg">.</span>open<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#39;r&#39;</span><span class="ansi-blue-fg">,</span> encoding<span class="ansi-blue-fg">=</span><span class="ansi-blue-fg">&#39;utf-8&#39;</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">]</span>

<span class="ansi-red-fg">NameError</span>: name &#39;Path&#39; is not defined
</pre></div></div>
</div>
</div>
<div class="section" id="Combine-lists-and-remove-content-from-tokenized_corpus">
<h4>Combine lists and remove content from <code class="docutils literal notranslate"><span class="pre">tokenized_corpus</span></code><a class="headerlink" href="#Combine-lists-and-remove-content-from-tokenized_corpus" title="Permalink to this headline">¶</a></h4>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">features</span> <span class="o">=</span> <span class="n">stopwords</span> <span class="o">+</span> <span class="n">hapax_legomena</span> <span class="o">+</span> <span class="n">external_stopwords</span>
<span class="n">clean_tokenized_corpus</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">preprocessing</span><span class="o">.</span><span class="n">remove_features</span><span class="p">(</span><span class="n">features</span><span class="p">,</span> <span class="n">tokenized_corpus</span><span class="o">=</span><span class="n">tokenized_corpus</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-16-c7309f949339&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span>features <span class="ansi-blue-fg">=</span> stopwords <span class="ansi-blue-fg">+</span> hapax_legomena <span class="ansi-blue-fg">+</span> external_stopwords
<span class="ansi-green-intense-fg ansi-bold">      2</span> clean_tokenized_corpus <span class="ansi-blue-fg">=</span> list<span class="ansi-blue-fg">(</span>preprocessing<span class="ansi-blue-fg">.</span>remove_features<span class="ansi-blue-fg">(</span>features<span class="ansi-blue-fg">,</span> tokenized_corpus<span class="ansi-blue-fg">=</span>tokenized_corpus<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span>

<span class="ansi-red-fg">NameError</span>: name &#39;stopwords&#39; is not defined
</pre></div></div>
</div>
</div>
</div>
</div>
<div class="section" id="2.-Model-creation">
<h2>2. Model creation<a class="headerlink" href="#2.-Model-creation" title="Permalink to this headline">¶</a></h2>
<p>Now we must tell the library where to find the local instance of MALLET.
If you managed to install MALLET, it is sufficient set
<code class="docutils literal notranslate"><span class="pre">path_to_mallet</span> <span class="pre">=</span> <span class="pre">'mallet'</span></code>, if you store MALLET in a local folder,
you have to specify the path to the binary explictly (e.g.
<code class="docutils literal notranslate"><span class="pre">path_to_mallet</span> <span class="pre">=</span> <span class="pre">'C:/mallet-2.0.8/bin/mallet'</span></code>).</p>
<p><strong>Whitespaces are not allowed in the path!</strong></p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">path_to_mallet</span> <span class="o">=</span> <span class="s1">&#39;mallet&#39;</span>
</pre></div>
</div>
</div>
<div class="section" id="2.1.-Create-Mallet-object">
<h3>2.1. Create <code class="docutils literal notranslate"><span class="pre">Mallet</span></code> object<a class="headerlink" href="#2.1.-Create-Mallet-object" title="Permalink to this headline">¶</a></h3>
<p>Finally, we can instance the <code class="docutils literal notranslate"><span class="pre">Mallet</span></code> object.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">Mallet</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">Mallet</span><span class="p">(</span><span class="n">path_to_mallet</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-18-3147a7e7f8b9&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span>Mallet <span class="ansi-blue-fg">=</span> utils<span class="ansi-blue-fg">.</span>Mallet<span class="ansi-blue-fg">(</span>path_to_mallet<span class="ansi-blue-fg">)</span>

<span class="ansi-red-fg">NameError</span>: name &#39;utils&#39; is not defined
</pre></div></div>
</div>
<p>The object <code class="docutils literal notranslate"><span class="pre">Mallet</span></code> has a method <code class="docutils literal notranslate"><span class="pre">import_tokenized_corpus()</span></code> to
create a specific corpus file for MALLET.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">mallet_corpus</span> <span class="o">=</span> <span class="n">Mallet</span><span class="o">.</span><span class="n">import_tokenized_corpus</span><span class="p">(</span><span class="n">clean_tokenized_corpus</span><span class="p">,</span> <span class="n">meta</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-19-40900ba2535d&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span>mallet_corpus <span class="ansi-blue-fg">=</span> Mallet<span class="ansi-blue-fg">.</span>import_tokenized_corpus<span class="ansi-blue-fg">(</span>clean_tokenized_corpus<span class="ansi-blue-fg">,</span> meta<span class="ansi-blue-fg">[</span><span class="ansi-blue-fg">&#39;title&#39;</span><span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">)</span>

<span class="ansi-red-fg">NameError</span>: name &#39;Mallet&#39; is not defined
</pre></div></div>
</div>
<p>Furthermore, <code class="docutils literal notranslate"><span class="pre">Mallet</span></code> has the method <code class="docutils literal notranslate"><span class="pre">train_topics()</span></code> to create and
train the LDA model. To create a LDA model, there have to be specified a
couple of parameters.</p>
<p>But first, if you are curious about any library, module, class or
function, try <code class="docutils literal notranslate"><span class="pre">help()</span></code>. This can be very useful, because (at least in
a well documented library) explanations of use and parameters will be
printed. We’re interested in the function <code class="docutils literal notranslate"><span class="pre">Mallet.train_topics()</span></code> in
the module <code class="docutils literal notranslate"><span class="pre">dariah_topics.mallet</span></code>, so let’s try:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">mallet</span><span class="o">.</span><span class="n">Mallet</span><span class="p">)</span>
</pre></div>
</div>
<p>This will print something like this (in fact even more):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Help on method train_topics in module dariah_topics.mallet:

train_topics(mallet_binary, **kwargs) method of dariah_topics.mallet.Mallet instance
    Args:
        input_model (str): Absolute path to the binary topic model created by `output_model`.
        output_model (str): Write a serialized MALLET topic trainer object.
            This type of output is appropriate for pausing and restarting training,
            but does not produce data that can easily be analyzed.
        output_topic_keys (str): Write the top words for each topic and any
            Dirichlet parameters to file.
        topic_word_weights_file (str): Write unnormalized weights for every
            topic and word type.
        word_topic_counts_file (str): Write a sparse representation of topic-word
            assignments. By default this is null, indicating that no file will
            be written.
        output_doc_topics (str): Write the topic proportions per document, at
            the end of the iterations.
        num_topics (int): Number of topics. Defaults to 10.
        num_top_words (int): Number of keywords for each topic. Defaults to 10.
        num_interations (int): Number of iterations. Defaults to 1000.
        num_threads (int): Number of threads for parallel training.  Defaults to 1.
        num_icm_iterations (int): Number of iterations of iterated conditional
            modes (topic maximization).  Defaults to 0.
        no_inference (bool): Load a saved model and create a report. Equivalent
            to `num_iterations = 0`. Defaults to False.
        random_seed (int): Random seed for the Gibbs sampler. Defaults to 0.
        optimize_interval (int): Number of iterations between reestimating
            dirichlet hyperparameters. Defaults to 0.
        optimize_burn_in (int): Number of iterations to run before first
            estimating dirichlet hyperparameters. Defaults to 200.
        use_symmetric_alpha (bool): Only optimize the concentration parameter of
            the prior over document-topic distributions. This may reduce the
            number of very small, poorly estimated topics, but may disperse common
            words over several topics. Defaults to False.
        alpha (float): Sum over topics of smoothing over doc-topic distributions.
            alpha_k = [this value] / [num topics]. Defaults to 5.0.
        beta (float): Smoothing parameter for each topic-word. Defaults to 0.01.
</pre></div>
</div>
<p>So, now you know how to define the number of topics and the number of
sampling iterations as well. A higher number of iterations will probably
yield a better model, but also increases processing time. <code class="docutils literal notranslate"><span class="pre">alpha</span></code> and
<code class="docutils literal notranslate"><span class="pre">beta</span></code> are so-called <em>hyperparameters</em>. They influence the model’s
performance, so feel free to play around with them. In the present
example, we will leave the default values. Furthermore, there exist
various methods for hyperparameter optimization, e.g. gridsearch or
Gaussian optimization.</p>
<p><strong>Warning: This step can take quite a while!</strong> Meaning something between
some seconds and some hours depending on corpus size and the number of
iterations. Our example corpus should be done within a minute or two at
<code class="docutils literal notranslate"><span class="pre">num_iterations=1000</span></code>.</p>
<p>First, create an output folder:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">output</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="s1">&#39;mallet_output&#39;</span><span class="p">)</span>

<span class="k">if</span> <span class="ow">not</span> <span class="n">output</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
    <span class="n">output</span><span class="o">.</span><span class="n">mkdir</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-20-5d3017386220&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span>output <span class="ansi-blue-fg">=</span> Path<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#39;data&#39;</span><span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">&#39;mallet_output&#39;</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">      2</span>
<span class="ansi-green-intense-fg ansi-bold">      3</span> <span class="ansi-green-fg">if</span> <span class="ansi-green-fg">not</span> output<span class="ansi-blue-fg">.</span>exists<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">      4</span>     output<span class="ansi-blue-fg">.</span>mkdir<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>

<span class="ansi-red-fg">NameError</span>: name &#39;Path&#39; is not defined
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">%%</span><span class="k">time</span>

Mallet.train_topics(mallet_corpus,
                    output_topic_keys=str(Path(output, &#39;topic_keys.txt&#39;)),
                    output_doc_topics=str(Path(output, &#39;doc_topics.txt&#39;)),
                    num_topics=10,
                    num_iterations=1000)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
<span class="ansi-green-fg">&lt;timed eval&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span><span class="ansi-blue-fg">()</span>

<span class="ansi-red-fg">NameError</span>: name &#39;Mallet&#39; is not defined
</pre></div></div>
</div>
<p>If you are curious about MALLET’s logging, have a look at the file
<code class="docutils literal notranslate"><span class="pre">mallet.log</span></code>, which should have been created in the same directory as
your notebook is.</p>
</div>
<div class="section" id="2.4.-Create-document-topic-matrix">
<h3>2.4. Create document-topic matrix<a class="headerlink" href="#2.4.-Create-document-topic-matrix" title="Permalink to this headline">¶</a></h3>
<p>The generated model object can now be translated into a human-readable
document-topic matrix (that is a actually a pandas data frame) that
constitutes our principle exchange format for topic modeling results.
For generating the matrix from a Gensim model, we can use the following
function:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">topics</span> <span class="o">=</span> <span class="n">postprocessing</span><span class="o">.</span><span class="n">show_topics</span><span class="p">(</span><span class="n">topic_keys_file</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="s1">&#39;topic_keys.txt&#39;</span><span class="p">)))</span>
<span class="n">topics</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-22-a91e7e9e31a3&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span>topics <span class="ansi-blue-fg">=</span> postprocessing<span class="ansi-blue-fg">.</span>show_topics<span class="ansi-blue-fg">(</span>topic_keys_file<span class="ansi-blue-fg">=</span>str<span class="ansi-blue-fg">(</span>Path<span class="ansi-blue-fg">(</span>output<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">&#39;topic_keys.txt&#39;</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">      2</span> topics

<span class="ansi-red-fg">NameError</span>: name &#39;postprocessing&#39; is not defined
</pre></div></div>
</div>
</div>
</div>
<div class="section" id="3.-Visualization">
<h2>3. Visualization<a class="headerlink" href="#3.-Visualization" title="Permalink to this headline">¶</a></h2>
<p>Each topic has a certain probability for each document in the corpus
(have a look at the cell below). This probability distributions are
visualized in an interactive <strong>heatmap</strong> (the darker the color, the
higher the probability) which displays the kind of information that is
presumably most useful to literary scholars. Going beyond pure
exploration, this visualization can be used to show thematic
developments over a set of texts as well as a single text, akin to a
dynamic topic model. What might become apparent here, is that some
topics correlate highly with a specific author or group of authors,
while other topics correlate highly with a specific text or group of
texts.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">document_topics</span> <span class="o">=</span> <span class="n">postprocessing</span><span class="o">.</span><span class="n">show_document_topics</span><span class="p">(</span><span class="n">topics</span><span class="o">=</span><span class="n">topics</span><span class="p">,</span>
                                                      <span class="n">doc_topics_file</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="s1">&#39;doc_topics.txt&#39;</span><span class="p">)))</span>
<span class="n">document_topics</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-23-b8e011939867&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> document_topics = postprocessing.show_document_topics(topics=topics,
</span><span class="ansi-green-intense-fg ansi-bold">      2</span>                                                       doc_topics_file=str(Path(output, &#39;doc_topics.txt&#39;)))
<span class="ansi-green-intense-fg ansi-bold">      3</span> document_topics<span class="ansi-blue-fg">[</span><span class="ansi-blue-fg">:</span><span class="ansi-cyan-fg">5</span><span class="ansi-blue-fg">]</span>

<span class="ansi-red-fg">NameError</span>: name &#39;postprocessing&#39; is not defined
</pre></div></div>
</div>
<div class="section" id="3.1.-Distribution-of-topics">
<h3>3.1. Distribution of topics<a class="headerlink" href="#3.1.-Distribution-of-topics" title="Permalink to this headline">¶</a></h3>
<div class="section" id="Distribution-of-topics-over-all-documents">
<h4>Distribution of topics over all documents<a class="headerlink" href="#Distribution-of-topics-over-all-documents" title="Permalink to this headline">¶</a></h4>
<p>The distribution of topics over all documents can now be visualized in
an interactive heatmap.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">bokeh.io</span> <span class="k">import</span> <span class="n">output_notebook</span><span class="p">,</span> <span class="n">show</span>
<span class="n">output_notebook</span><span class="p">()</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="bk-root">
    <a href="https://bokeh.pydata.org" target="_blank" class="bk-logo bk-logo-small bk-logo-notebook"></a>
    <span id="26e43ced-522e-4ad3-a7e3-3b28e37d46fe">Loading BokehJS ...</span>
</div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div></div>
<script type="text/javascript">
var element = document.currentScript.previousSibling.previousSibling;

(function(root) {
  function now() {
    return new Date();
  }

  var force = true;

  if (typeof (root._bokeh_onload_callbacks) === "undefined" || force === true) {
    root._bokeh_onload_callbacks = [];
    root._bokeh_is_loading = undefined;
  }

  var JS_MIME_TYPE = 'application/javascript';
  var HTML_MIME_TYPE = 'text/html';
  var EXEC_MIME_TYPE = 'application/vnd.bokehjs_exec.v0+json';
  var CLASS_NAME = 'output_bokeh rendered_html';

  /**
   * Render data to the DOM node
   */
  function render(props, node) {
    var script = document.createElement("script");
    node.appendChild(script);
  }

  /**
   * Handle when an output is cleared or removed
   */
  function handleClearOutput(event, handle) {
    var cell = handle.cell;

    var id = cell.output_area._bokeh_element_id;
    var server_id = cell.output_area._bokeh_server_id;
    // Clean up Bokeh references
    if (id !== undefined) {
      Bokeh.index[id].model.document.clear();
      delete Bokeh.index[id];
    }

    if (server_id !== undefined) {
      // Clean up Bokeh references
      var cmd = "from bokeh.io.state import curstate; print(curstate().uuid_to_server['" + server_id + "'].get_sessions()[0].document.roots[0]._id)";
      cell.notebook.kernel.execute(cmd, {
        iopub: {
          output: function(msg) {
            var element_id = msg.content.text.trim();
            Bokeh.index[element_id].model.document.clear();
            delete Bokeh.index[element_id];
          }
        }
      });
      // Destroy server and session
      var cmd = "import bokeh.io.notebook as ion; ion.destroy_server('" + server_id + "')";
      cell.notebook.kernel.execute(cmd);
    }
  }

  /**
   * Handle when a new output is added
   */
  function handleAddOutput(event, handle) {
    var output_area = handle.output_area;
    var output = handle.output;

    // limit handleAddOutput to display_data with EXEC_MIME_TYPE content only
    if ((output.output_type != "display_data") || (!output.data.hasOwnProperty(EXEC_MIME_TYPE))) {
      return
    }

    var toinsert = output_area.element.find("." + CLASS_NAME.split(' ')[0]);

    if (output.metadata[EXEC_MIME_TYPE]["id"] !== undefined) {
      toinsert[toinsert.length - 1].firstChild.textContent = output.data[JS_MIME_TYPE];
      // store reference to embed id on output_area
      output_area._bokeh_element_id = output.metadata[EXEC_MIME_TYPE]["id"];
    }
    if (output.metadata[EXEC_MIME_TYPE]["server_id"] !== undefined) {
      var bk_div = document.createElement("div");
      bk_div.innerHTML = output.data[HTML_MIME_TYPE];
      var script_attrs = bk_div.children[0].attributes;
      for (var i = 0; i < script_attrs.length; i++) {
        toinsert[toinsert.length - 1].firstChild.setAttribute(script_attrs[i].name, script_attrs[i].value);
      }
      // store reference to server id on output_area
      output_area._bokeh_server_id = output.metadata[EXEC_MIME_TYPE]["server_id"];
    }
  }

  function register_renderer(events, OutputArea) {

    function append_mime(data, metadata, element) {
      // create a DOM node to render to
      var toinsert = this.create_output_subarea(
        metadata,
        CLASS_NAME,
        EXEC_MIME_TYPE
      );
      this.keyboard_manager.register_events(toinsert);
      // Render to node
      var props = {data: data, metadata: metadata[EXEC_MIME_TYPE]};
      render(props, toinsert[toinsert.length - 1]);
      element.append(toinsert);
      return toinsert
    }

    /* Handle when an output is cleared or removed */
    events.on('clear_output.CodeCell', handleClearOutput);
    events.on('delete.Cell', handleClearOutput);

    /* Handle when a new output is added */
    events.on('output_added.OutputArea', handleAddOutput);

    /**
     * Register the mime type and append_mime function with output_area
     */
    OutputArea.prototype.register_mime_type(EXEC_MIME_TYPE, append_mime, {
      /* Is output safe? */
      safe: true,
      /* Index of renderer in `output_area.display_order` */
      index: 0
    });
  }

  // register the mime type if in Jupyter Notebook environment and previously unregistered
  if (root.Jupyter !== undefined) {
    var events = require('base/js/events');
    var OutputArea = require('notebook/js/outputarea').OutputArea;

    if (OutputArea.prototype.mime_types().indexOf(EXEC_MIME_TYPE) == -1) {
      register_renderer(events, OutputArea);
    }
  }


  if (typeof (root._bokeh_timeout) === "undefined" || force === true) {
    root._bokeh_timeout = Date.now() + 5000;
    root._bokeh_failed_load = false;
  }

  var NB_LOAD_WARNING = {'data': {'text/html':
     "<div style='background-color: #fdd'>\n"+
     "<p>\n"+
     "BokehJS does not appear to have successfully loaded. If loading BokehJS from CDN, this \n"+
     "may be due to a slow or bad network connection. Possible fixes:\n"+
     "</p>\n"+
     "<ul>\n"+
     "<li>re-rerun `output_notebook()` to attempt to load from CDN again, or</li>\n"+
     "<li>use INLINE resources instead, as so:</li>\n"+
     "</ul>\n"+
     "<code>\n"+
     "from bokeh.resources import INLINE\n"+
     "output_notebook(resources=INLINE)\n"+
     "</code>\n"+
     "</div>"}};

  function display_loaded() {
    var el = document.getElementById("26e43ced-522e-4ad3-a7e3-3b28e37d46fe");
    if (el != null) {
      el.textContent = "BokehJS is loading...";
    }
    if (root.Bokeh !== undefined) {
      if (el != null) {
        el.textContent = "BokehJS " + root.Bokeh.version + " successfully loaded.";
      }
    } else if (Date.now() < root._bokeh_timeout) {
      setTimeout(display_loaded, 100)
    }
  }


  function run_callbacks() {
    try {
      root._bokeh_onload_callbacks.forEach(function(callback) { callback() });
    }
    finally {
      delete root._bokeh_onload_callbacks
    }
    console.info("Bokeh: all callbacks have finished");
  }

  function load_libs(js_urls, callback) {
    root._bokeh_onload_callbacks.push(callback);
    if (root._bokeh_is_loading > 0) {
      console.log("Bokeh: BokehJS is being loaded, scheduling callback at", now());
      return null;
    }
    if (js_urls == null || js_urls.length === 0) {
      run_callbacks();
      return null;
    }
    console.log("Bokeh: BokehJS not loaded, scheduling load and callback at", now());
    root._bokeh_is_loading = js_urls.length;
    for (var i = 0; i < js_urls.length; i++) {
      var url = js_urls[i];
      var s = document.createElement('script');
      s.src = url;
      s.async = false;
      s.onreadystatechange = s.onload = function() {
        root._bokeh_is_loading--;
        if (root._bokeh_is_loading === 0) {
          console.log("Bokeh: all BokehJS libraries loaded");
          run_callbacks()
        }
      };
      s.onerror = function() {
        console.warn("failed to load library " + url);
      };
      console.log("Bokeh: injecting script tag for BokehJS library: ", url);
      document.getElementsByTagName("head")[0].appendChild(s);
    }
  };var element = document.getElementById("26e43ced-522e-4ad3-a7e3-3b28e37d46fe");
  if (element == null) {
    console.log("Bokeh: ERROR: autoload.js configured with elementid '26e43ced-522e-4ad3-a7e3-3b28e37d46fe' but no matching script tag was found. ")
    return false;
  }

  var js_urls = ["https://cdn.pydata.org/bokeh/release/bokeh-0.12.15.min.js", "https://cdn.pydata.org/bokeh/release/bokeh-widgets-0.12.15.min.js", "https://cdn.pydata.org/bokeh/release/bokeh-tables-0.12.15.min.js", "https://cdn.pydata.org/bokeh/release/bokeh-gl-0.12.15.min.js"];

  var inline_js = [
    function(Bokeh) {
      Bokeh.set_log_level("info");
    },

    function(Bokeh) {

    },
    function(Bokeh) {
      console.log("Bokeh: injecting CSS: https://cdn.pydata.org/bokeh/release/bokeh-0.12.15.min.css");
      Bokeh.embed.inject_css("https://cdn.pydata.org/bokeh/release/bokeh-0.12.15.min.css");
      console.log("Bokeh: injecting CSS: https://cdn.pydata.org/bokeh/release/bokeh-widgets-0.12.15.min.css");
      Bokeh.embed.inject_css("https://cdn.pydata.org/bokeh/release/bokeh-widgets-0.12.15.min.css");
      console.log("Bokeh: injecting CSS: https://cdn.pydata.org/bokeh/release/bokeh-tables-0.12.15.min.css");
      Bokeh.embed.inject_css("https://cdn.pydata.org/bokeh/release/bokeh-tables-0.12.15.min.css");
    }
  ];

  function run_inline_js() {

    if ((root.Bokeh !== undefined) || (force === true)) {
      for (var i = 0; i < inline_js.length; i++) {
        inline_js[i].call(root, root.Bokeh);
      }if (force === true) {
        display_loaded();
      }} else if (Date.now() < root._bokeh_timeout) {
      setTimeout(run_inline_js, 100);
    } else if (!root._bokeh_failed_load) {
      console.log("Bokeh: BokehJS failed to load within specified timeout.");
      root._bokeh_failed_load = true;
    } else if (force !== true) {
      var cell = $(document.getElementById("26e43ced-522e-4ad3-a7e3-3b28e37d46fe")).parents('.cell').data().cell;
      cell.output_area.append_execute_result(NB_LOAD_WARNING)
    }

  }

  if (root._bokeh_is_loading === 0) {
    console.log("Bokeh: BokehJS loaded, going straight to plotting");
    run_inline_js();
  } else {
    load_libs(js_urls, function() {
      console.log("Bokeh: BokehJS plotting callback run at", now());
      run_inline_js();
    });
  }
}(window));
</script></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">PlotDocumentTopics</span> <span class="o">=</span> <span class="n">visualization</span><span class="o">.</span><span class="n">PlotDocumentTopics</span><span class="p">(</span><span class="n">document_topics</span><span class="p">)</span>
<span class="n">show</span><span class="p">(</span><span class="n">PlotDocumentTopics</span><span class="o">.</span><span class="n">interactive_heatmap</span><span class="p">(),</span> <span class="n">notebook_handle</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-25-3c545f10dd80&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span>PlotDocumentTopics <span class="ansi-blue-fg">=</span> visualization<span class="ansi-blue-fg">.</span>PlotDocumentTopics<span class="ansi-blue-fg">(</span>document_topics<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">      2</span> show<span class="ansi-blue-fg">(</span>PlotDocumentTopics<span class="ansi-blue-fg">.</span>interactive_heatmap<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">,</span> notebook_handle<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">True</span><span class="ansi-blue-fg">)</span>

<span class="ansi-red-fg">NameError</span>: name &#39;visualization&#39; is not defined
</pre></div></div>
</div>
<p>Or a static heatmap:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">static_heatmap</span> <span class="o">=</span> <span class="n">PlotDocumentTopics</span><span class="o">.</span><span class="n">static_heatmap</span><span class="p">()</span>
<span class="n">static_heatmap</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-26-3fe6e2bf8643&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span>static_heatmap <span class="ansi-blue-fg">=</span> PlotDocumentTopics<span class="ansi-blue-fg">.</span>static_heatmap<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">      2</span> static_heatmap<span class="ansi-blue-fg">.</span>show<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>

<span class="ansi-red-fg">NameError</span>: name &#39;PlotDocumentTopics&#39; is not defined
</pre></div></div>
</div>
</div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
    <div class="clearer"></div>
  </div>
    <div class="footer">
      &copy;2017-2018, DARIAH-DE Group Würzburg.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.7.4</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.10</a>
      
      |
      <a href="../_sources/notebooks/IntroducingMallet.ipynb.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>